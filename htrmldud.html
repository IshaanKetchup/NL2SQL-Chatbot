<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SQL Query Generator</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/feather-icons"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">
<link rel="stylesheet" href="style.css">
</head>
<body class="font-sans enable-motion">
<div class="flex flex-col h-screen bg-neutral-950 text-neutral-100 overflow-hidden">

<!-- Header -->
<header class="sticky top-0 z-30 flex items-center justify-between p-4 border-b bg-neutral-900/90 backdrop-blur-sm border-neutral-800 flex-shrink-0">
    <h1 class="text-xl font-semibold text-neutral-100 flex items-center gap-2">
        <i data-feather="database" class="w-6 h-6 text-neutral-300"></i>
        SQL Query Generator
    </h1>
    <div class="flex items-center gap-2">
        <button id="clear-chat" class="icon-btn w-8 h-8" aria-label="Clear chat">
            <i data-feather="trash-2" class="w-4 h-4"></i>
        </button>
        <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" id="theme-toggle" class="sr-only peer">
            <div class="w-11 h-6 bg-neutral-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-neutral-600 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-neutral-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-neutral-600"></div>
            <span class="ml-3 text-sm font-medium text-neutral-300">
                <i data-feather="moon" class="w-4 h-4"></i>
            </span>
        </label>
    </div>
</header>

<div class="flex flex-1 overflow-hidden relative">

    <!-- Toggle button -->
    <div id="toggle-schema" class="hover:animate-hover-lift">
        <i data-feather="chevron-left" id="toggle-icon"></i>
    </div>

    <!-- Left panel - Schema -->
    <div id="schema-wrapper" class="w-1/3 min-w-[280px] max-w-[400px] dark-panel overflow-y-auto p-4 transition-all duration-300">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-lg font-semibold text-neutral-100">Database Schema</h2>
            <button class="icon-btn" onclick="fetchSchemaFromBackend()" title="Refresh schema">
                <i data-feather="refresh-ccw" class="w-4 h-4"></i>
            </button>
        </div>

        <div id="schema-section">
            <div id="schema-body">
                <!-- Tables will be rendered here by JavaScript -->
            </div>
            <div class="mt-4 space-y-2">
                <button onclick="addTable()" class="btn btn-secondary w-full flex items-center justify-center gap-2">
                    <i data-feather="plus" class="w-4 h-4"></i>
                    Add Table
                </button>
                <button onclick="saveSchemaToBackend()" class="btn btn-primary w-full flex items-center justify-center gap-2">
                    <i data-feather="save" class="w-4 h-4"></i>
                    Save Schema
                </button>
                <button onclick="uploadSchema()" class="btn btn-secondary w-full flex items-center justify-center gap-2">
                    <i data-feather="upload" class="w-4 h-4"></i>
                    Import Schema
                </button>
            </div>
        </div>
    </div>

    <!-- Right panel - Chat -->
    <div id="chat-panel" class="flex-1 flex flex-col bg-neutral-950">
        <div id="chat-container" class="flex-1 p-4 overflow-y-auto space-y-4">
            <!-- Welcome Message -->
            <div class="message bg-blue-900/20 chat-message p-4 max-w-[85%]">
                <div class="flex items-start gap-3">
                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-900 flex items-center justify-center">
                        <i data-feather="database" class="w-4 h-4 text-blue-300"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="font-medium text-blue-200 mb-1">SQL Assistant</p>
                        <div class="message-content">
                            <p class="text-neutral-300 mb-3">Hi! I can help you generate SQL queries based on your database schema. Ask me anything like "Show me all users" or "Find orders from last month".</p>
                            <div class="bg-neutral-900 rounded-lg p-3 border border-neutral-800 relative">
                                <button class="absolute right-2 top-2 icon-btn w-8 h-8 bg-neutral-800 hover:bg-neutral-700 copy-btn" data-sql="SELECT * FROM users 
WHERE email LIKE '%@example.com'
ORDER BY name ASC;">
                                    <i data-feather="copy" class="w-4 h-4"></i>
                                </button>
                                <pre class="text-sm font-mono text-neutral-200 overflow-x-auto"><code><span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> users 
<span class="sql-keyword">WHERE</span> email <span class="sql-keyword">LIKE</span> <span class="sql-string">'%@example.com'</span>
<span class="sql-keyword">ORDER BY</span> name <span class="sql-keyword">ASC</span>;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="bg-neutral-900 border-t border-neutral-800 p-4 flex-shrink-0">
            <div class="flex gap-2">
                <div class="relative flex-1">
                    <input id="message-input" type="text" placeholder="Describe the SQL query you need..." 
                        class="w-full pl-4 pr-24 py-3 border border-neutral-700 rounded-lg bg-neutral-950 text-neutral-100 placeholder:text-neutral-500 focus:ring-2 focus:ring-neutral-600 focus:border-neutral-600 transition-colors text-base"
                        autocomplete="off">
                    <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex gap-1">
                        <button class="icon-btn w-8 h-8" onclick="uploadSchema()" title="Import schema">
                            <i data-feather="upload" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
                <button id="send-button" class="btn btn-primary px-5 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    <i data-feather="send" class="w-4 h-4"></i>
                    Send
                </button>
            </div>
            <p class="text-xs text-neutral-500 mt-2 ml-1">Press Enter to send, Shift+Enter for new line</p>
        </div>
    </div>

</div>
</div>

<script src="script.js"></script>
</body>
</html>
